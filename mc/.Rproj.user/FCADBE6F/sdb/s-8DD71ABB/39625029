{
    "contents" : "#########################################\n# classifySubjects.R - Classify subjects\n# Author: Hoai Tuong Nguyen\n# Created: 30/05/2013\n# Modified: 07/06/2013\n# CMD: R --no-save --no-restore --slave -f classifySubjects.R \"--args input.dir='?' output.dir='?'\"\n#########################################\n\n#First read and parse the arguments for on the fly run\nargs=(commandArgs(TRUE))\n\nfor(i in 1:length(args)){\n  eval(parse(text=args[[i]]))\n}\n\n\n\n#default working path for inner run\n#setwd(\"MetaCARDIS/\")\n  \n#default input and output paths\nif (!exists(\"input.dir\"))\n  input.dir=\"../1.data/metacardis\"\nif (!exists(\"output.dir\"))\n  output.dir=\"../3.results\"\n\n#Load imputed data\nclinic.data<-get(load(sprintf(\"%s/DonneeCliniques0_6_12Sem_3avril2010.xls.imputed.RData\",input.dir)))\nseqcount.data<-get(load(sprintf(\"%s/DonneeCliniques0_6_12Sem_3avril2010.xls.imputed.RData\",input.dir)))\n\n\n\n\n#FUNC plot a pair of variables and lowess line\n#Dependencies: Hmisc\nreg.plot<-function(x,y,type=\"lm\",pch,subjects=NULL,title=\"CORRELATION\",xlab=\"X\",ylab=\"Y\",col,legend.topleft,legend.topright,imgfile=NULL,pointsfile=NULL){\n  \n  #correlation\n  r=rcorr(x,y,type=\"pearson\")[[1]][1,2]\n  rho=rcorr(x,y,type=\"spearman\")[[1]][1,2]\n  \n  #output plot\n  if (!missing(imgfile))\n    pdf(file=imgfile)\n  \n  #colors of points\n  if (missing(col))\n    col=rep(\"black\",length(x),)\n  \n  #main plot\n  plot(x,y,pch=pch,main=sprintf(\"%s\\n%s vs %s \\nr=%0.4f; rho=%0.4f\",title,ylab,xlab,r,rho),xlab=xlab,ylab=ylab,col=col)\n  \n  #labels\n  text(x, y, subjects, cex=0.3,pos=1,offset=0.2)\n  \n  #Regression line\n  if (type==\"lowess\"){\n    lw<-lowess(x,y)\n    lines(lw,col=3)\n    up<-which(x>lw$x & y>lw$y)\n  } else if (type==\"lm\") {\n    lm<-lm(y~x)\n    abline(lm)\n    up<-which(y>fitted(lm))\n  }\n  \n  #Legend  \n  if (!missing(legend.topleft))\n    legend(\"topleft\", title=legend.topleft$title,pch=legend.topleft$pch, legend = legend.topleft$label, col = legend.topleft$col, cex=0.4)\n  if (!missing(legend.topright))\n    legend(\"topright\", title=legend.topright$title,pch=legend.topright$pch, legend = legend.topright$label, col = legend.topright$col, cex=0.4)\n  \n  \n  #output points\n  if (!missing(pointsfile)){\n    p<-rep(\"0\",length(x))\n    p[up]<-\"1\"\n    if (!missing(subjects))\n      write.table(rbind(c(\"Name\",xlab,ylab,\"Levels\"),cbind(subjects,x,y,p)),file=pointsfile,col.names=F,row.names=F,sep=\",\",quote=F)\n    else \n      write.table(rbind(c(xlab,ylab,\"Levels\"),cbind(x,y,p)),file=pointsfile,col.names=F,row.names=T,quote=F)\n  }\n  \n  #end of output plot\n  if (!missing(imgfile))\n    dev.off()\n  \n}\n\n\n\n\n\n\n#Dependencies loading...\nrequire(\"Hmisc\")\n\n#Annotation\n#\"diam_clin\" = adipocyte diametre\n#\"tour.de.taille_clin\"= Waist\n#\"MG.kg_clin\" = Fat mas en KG (absolu)\n#\"MG.percent_clin\" = Fat mass/body weight %\n#\"Taille\"= Height\n\n\n#t0 - \"Adipocyte diameter\" vs \"Fat mass\" by LOWESS\nreg.plot(clinic.data$MG.kg_clin[1:49],clinic.data$diam_clin[1:49],\n         type=\"lowess\",\n         pch=ifelse(clinic.data$Sexe[1:49]==\"M\", 0, 1),         \n         subjects=as.vector(clinic.data$NOM[1:49]),\n         title=\"CORRELATION (T0) - LOWESS\",\n         xlab=\"Fat mass\",ylab=\"Adipocyte diameter\",\n         legend.topright=list(title=\"SHAPE\",pch=c(1,0),label=c(\"Female\",\"Male\"),col=c(\"black\",\"black\")),\n         imgfile=sprintf(\"%s/lw_t0_Adipocyte-diameter_vs_Fat-mass.pdf\",output.dir),\n         pointsfile=sprintf(\"%s/lw_t0_Adipocyte-diameter_vs_Fat-mass_points.csv\",output.dir))\n\n#t0 - \"Waist\" vs \"Fat mass/Height*Height\" by LOWESS\nx=clinic.data$MG.kg_clin[1:49]/(clinic.data$Taille[1:49]*clinic.data$Taille[1:49])\nreg.plot(x,clinic.data$tour.de.taille_clin[1:49],\n         type=\"lowess\",\n         pch=ifelse(clinic.data$Sexe[1:49]==\"M\", 0, 1),\n         subjects=as.vector(clinic.data$NOM[1:49]),\n         title=\"CORRELATION (T0) - LOWESS\",\n         xlab=\"Fat mass/Height*Height\",ylab=\"Waist\",\n         legend.topright=list(title=\"SHAPE\",pch=c(1,0),label=c(\"Female\",\"Male\"),col=c(\"black\",\"black\")),\n         imgfile=sprintf(\"%s/lw_t0_Waist_vs_Fat-mass_Height2.pdf\",output.dir),\n         pointsfile=sprintf(\"%s/lw_t0_Waist_vs_Fat-mass_Height2_points.csv\",output.dir))\n\n\n#t0 - \"Waist\" vs \"Fat mass/Height*Height*Height\" by LOWESS\nx=clinic.data$MG.kg_clin[1:49]/(clinic.data$Taille[1:49]*clinic.data$Taille[1:49]*clinic.data$Taille[1:49])\nreg.plot(x,clinic.data$tour.de.taille_clin[1:49],\n         type=\"lowess\",\n         pch=ifelse(clinic.data$Sexe[1:49]==\"M\", 0, 1),\n         subjects=as.vector(clinic.data$NOM[1:49]),\n         title=\"CORRELATION (T0) - LOWESS\",\n         xlab=\"Fat mass/Height*Height*Height\",ylab=\"Waist\",\n         legend.topright=list(title=\"SHAPE\",pch=c(1,0),label=c(\"Female\",\"Male\"),col=c(\"black\",\"black\")),\n         imgfile=sprintf(\"%s/lw_t0_Waist_vs_Fat-mass_Height3.pdf\",output.dir),\n         pointsfile=sprintf(\"%s/lw_t0_Waist_vs_Fat-mass_Height3_points.csv\",output.dir))\n\n\n#t0 - \"Adipocyte diameter\" vs \"Waist/Height*Height\" by LOWESS\nreg.plot(clinic.data$tour.de.taille_clin[1:49]/(clinic.data$Taille[1:49]*clinic.data$Taille[1:49]),clinic.data$diam_clin[1:49],\n         type=\"lowess\",\n         pch=ifelse(clinic.data$Sexe[1:49]==\"M\", 0, 1),\n         subjects=as.vector(clinic.data$NOM[1:49]),\n         title=\"CORRELATION (T0) - LOWESS\",\n         xlab=\"Waist/Height*Height\",ylab=\"Adipocyte diameter\",\n         legend.topleft=list(title=\"SHAPE\",pch=c(1,0),label=c(\"Female\",\"Male\"),col=c(\"black\",\"black\")),\n         imgfile=sprintf(\"%s/lw_t0_Adipocyte-diameter_vs_Waist_Height2.pdf\",output.dir),\n         pointsfile=sprintf(\"%s/lw_t0_Adipocyte-diameter_vs_Waist_Height2_points.csv\",output.dir))\n\n\n\n\n#t0-t9-t12 - \"Adipocyte diameter\" vs \"Fat mass\" by LOWESS\nreg.plot(clinic.data$MG.kg_clin,clinic.data$diam_clin,\n         type=\"lowess\",\n         pch=ifelse(clinic.data$Sexe[1:49]==\"M\", 0, 1),   \n         subjects=as.vector(clinic.data$NOM),\n         title=\"CORRELATION (T0-T9-T12) - LOWESS\",\n         xlab=\"Fat mass\",ylab=\"Adipocyte diameter\",\n         col=c(rep(\"black\",49),rep(\"blue\",49),rep(\"red\",49)),\n         legend.topleft=list(title=\"COLOR\",pch=c(\"-\",\"-\",\"-\"),label=c(\"T0\",\"T9\",\"T12\"),col=c(\"black\",\"blue\",\"red\")),\n         legend.topright=list(title=\"SHAPE\",pch=c(1,0),label=c(\"Female\",\"Male\"),col=c(\"black\",\"black\")),\n         imgfile=sprintf(\"%s/lw_t0-t9-t12_Adipocyte-diameter_vs_Fat-mass.pdf\",output.dir),\n         pointsfile=sprintf(\"%s/lw_t0-t9-t12_Adipocyte-diameter_vs_Fat-mass_points.csv\",output.dir))\n\n#t0-t9-t12 - \"Waist\" vs \"Fat mass/Height*Height\" by LOWESS\nreg.plot(clinic.data$MG.kg_clin/(clinic.data$Taille*clinic.data$Taille),clinic.data$tour.de.taille_clin,\n         type=\"lowess\",\n         pch=ifelse(clinic.data$Sexe[1:49]==\"M\", 0, 1),\n         subjects=as.vector(clinic.data$NOM),\n         title=\"CORRELATION (T0-T9-T12) - LOWESS\",\n         xlab=\"Fat mass/Height*Height\",ylab=\"Waist\",\n         col=c(rep(\"black\",49),rep(\"blue\",49),rep(\"red\",49)),\n         legend.topleft=list(title=\"COLOR\",pch=c(\"-\",\"-\",\"-\"),label=c(\"T0\",\"T9\",\"T12\"),col=c(\"black\",\"blue\",\"red\")),\n         legend.topright=list(title=\"SHAPE\",pch=c(1,0),label=c(\"Female\",\"Male\"),col=c(\"black\",\"black\")),            \n         imgfile=sprintf(\"%s/lw_t0-t9-t12_Waist_vs_Fat-mass_Height2.pdf\",output.dir),\n         pointsfile=sprintf(\"%s/lw_t0-t9-t12_Waist_vs_Fat-mass_Height2_points.csv\",output.dir))\n\n\n#t0-t9-t12 - \"Adipocyte diameter\" vs \"Waist/Height*Height\" by LOWESS\nreg.plot(clinic.data$tour.de.taille_clin/(clinic.data$Taille*clinic.data$Taille),clinic.data$diam_clin,\n         type=\"lowess\",\n         pch=ifelse(clinic.data$Sexe[1:49]==\"M\", 0, 1), \n         subjects=as.vector(clinic.data$NOM),\n         title=\"CORRELATION (T0-T9-T12) - LOWESS\",\n         xlab=\"Waist/Height*Height\",ylab=\"Adipocyte diameter\",\n         col=c(rep(\"black\",49),rep(\"blue\",49),rep(\"red\",49)),\n         legend.topleft=list(title=\"COLOR\",pch=c(\"-\",\"-\",\"-\"),label=c(\"T0\",\"T9\",\"T12\"),col=c(\"black\",\"blue\",\"red\")),\n         legend.topright=list(title=\"SHAPE\",pch=c(1,0),label=c(\"Female\",\"Male\"),col=c(\"black\",\"black\")),\n         imgfile=sprintf(\"%s/lw_t0-t9-t12_Adipocyte-diameter_vs_Waist_Height2.pdf\",output.dir),\n         pointsfile=sprintf(\"%s/lw_t0-t9-t12_Adipocyte-diameter_vs_Waist_Height2_points.csv\",output.dir))\n\n\n\n\n\n\n\n\n#t0 - \"Adipocyte diameter\" vs \"Fat mass\" by Linear Regression\nreg.plot(clinic.data$MG.kg_clin[1:49],clinic.data$diam_clin[1:49],\n         type=\"lm\",\n         pch=ifelse(clinic.data$Sexe[1:49]==\"M\", 0, 1),\n         subjects=as.vector(clinic.data$NOM[1:49]),\n         title=\"CORRELATION (T0) - Linear Regression\",\n         xlab=\"Fat mass\",ylab=\"Adipocyte diameter\",\n         legend.topright=list(title=\"SHAPE\",pch=c(1,0),label=c(\"Female\",\"Male\"),col=c(\"black\",\"black\")),\n         imgfile=sprintf(\"%s/lm_t0_Adipocyte-diameter_vs_Fat-mass.pdf\",output.dir),\n         pointsfile=sprintf(\"%s/lm_t0_Adipocyte-diameter_vs_Fat-mass_points.csv\",output.dir))\n\n#t0 - \"Waist\" vs \"Fat mass/Height*Height\" by Linear Regression\nreg.plot(clinic.data$MG.kg_clin[1:49]/(clinic.data$Taille[1:49]*clinic.data$Taille[1:49]),clinic.data$tour.de.taille_clin[1:49],\n         type=\"lm\",\n         pch=ifelse(clinic.data$Sexe[1:49]==\"M\", 0, 1),\n         subjects=as.vector(clinic.data$NOM[1:49]),\n         title=\"CORRELATION (T0) - Linear Regression\",\n         xlab=\"Fat mass/Height*Height\",ylab=\"Waist\",\n         legend.topright=list(title=\"SHAPE\",pch=c(1,0),label=c(\"Female\",\"Male\"),col=c(\"black\",\"black\")),\n         imgfile=sprintf(\"%s/lm_t0_Waist_vs_Fat-mass_Height2.pdf\",output.dir),\n         pointsfile=sprintf(\"%s/lm_t0_Waist_vs_Fat-mass_Height2_points.csv\",output.dir))\n\n\n#t0 - \"Waist\" vs \"Fat mass/Height*Height*Height\" by Linear Regression\nx=clinic.data$MG.kg_clin[1:49]/(clinic.data$Taille[1:49]*clinic.data$Taille[1:49]*clinic.data$Taille[1:49])\nreg.plot(x,clinic.data$tour.de.taille_clin[1:49],\n         type=\"lm\",\n         pch=ifelse(clinic.data$Sexe[1:49]==\"M\", 0, 1),\n         subjects=as.vector(clinic.data$NOM[1:49]),\n         title=\"CORRELATION (T0) - Linear Regression\",\n         xlab=\"Fat mass/Height*Height*Height\",ylab=\"Waist\",\n         legend.topright=list(title=\"SHAPE\",pch=c(1,0),label=c(\"Female\",\"Male\"),col=c(\"black\",\"black\")),\n         imgfile=sprintf(\"%s/lm_t0_Waist_vs_Fat-mass_Height3.pdf\",output.dir),\n         pointsfile=sprintf(\"%s/lm_t0_Waist_vs_Fat-mass_Height3_points.csv\",output.dir))\n\n\n\n#t0 - \"Waist\" vs \"Fat mass/Height\" by Linear Regression\nx=clinic.data$MG.kg_clin[1:49]/(clinic.data$Taille[1:49])\nreg.plot(x,clinic.data$tour.de.taille_clin[1:49],\n         type=\"lm\",\n         pch=ifelse(clinic.data$Sexe[1:49]==\"M\", 0, 1),\n         subjects=as.vector(clinic.data$NOM[1:49]),\n         title=\"CORRELATION (T0) - Linear Regression\",\n         xlab=\"Fat mass/Height\",ylab=\"Waist\",\n         legend.topright=list(title=\"SHAPE\",pch=c(1,0),label=c(\"Female\",\"Male\"),col=c(\"black\",\"black\")),\n         imgfile=sprintf(\"%s/lm_t0_Waist_vs_Fat-mass_Height.pdf\",output.dir),\n         pointsfile=sprintf(\"%s/lm_t0_Waist_vs_Fat-mass_Height_points.csv\",output.dir))\n\n\n\n\n#t0 - \"Adipocyte diameter\" vs \"Waist/Height*Height\" by Linear Regression\nreg.plot(clinic.data$tour.de.taille_clin[1:49]/(clinic.data$Taille[1:49]*clinic.data$Taille[1:49]),clinic.data$diam_clin[1:49],\n         type=\"lm\",\n         pch=ifelse(clinic.data$Sexe[1:49]==\"M\", 0, 1),\n         subjects=as.vector(clinic.data$NOM[1:49]),\n         title=\"CORRELATION (T0) - Linear Regression\",\n         xlab=\"Waist/Height*Height\",ylab=\"Adipocyte diameter\",\n         legend.topleft=list(title=\"SHAPE\",pch=c(1,0),label=c(\"Female\",\"Male\"),col=c(\"black\",\"black\")),\n         imgfile=sprintf(\"%s/lm_t0_Adipocyte-diameter_vs_Waist_Height2.pdf\",output.dir),\n         pointsfile=sprintf(\"%s/lm_t0_Adipocyte-diameter_vs_Waist_Height2_points.csv\",output.dir))\n\n\n#t0 - \"Adipocyte diameter\" vs \"Waist/Height*Height*Height\" by Linear Regression\nreg.plot(clinic.data$tour.de.taille_clin[1:49]/(clinic.data$Taille[1:49]*clinic.data$Taille[1:49]*clinic.data$Taille[1:49]),clinic.data$diam_clin[1:49],\n         type=\"lm\",\n         pch=ifelse(clinic.data$Sexe[1:49]==\"M\", 0, 1),\n         subjects=as.vector(clinic.data$NOM[1:49]),\n         title=\"CORRELATION (T0) - Linear Regression\",\n         xlab=\"Waist/Height*Height*Height\",ylab=\"Adipocyte diameter\",\n         legend.topleft=list(title=\"SHAPE\",pch=c(1,0),label=c(\"Female\",\"Male\"),col=c(\"black\",\"black\")),\n         imgfile=sprintf(\"%s/lm_t0_Adipocyte-diameter_vs_Waist_Height3.pdf\",output.dir),\n         pointsfile=sprintf(\"%s/lm_t0_Adipocyte-diameter_vs_Waist_Height3_points.csv\",output.dir))\n\n\n#t0 - \"Adipocyte diameter\" vs \"Waist/Height\" by Linear Regression\nreg.plot(clinic.data$tour.de.taille_clin[1:49]/(clinic.data$Taille[1:49]),clinic.data$diam_clin[1:49],\n         type=\"lm\",\n         pch=ifelse(clinic.data$Sexe[1:49]==\"M\", 0, 1),\n         subjects=as.vector(clinic.data$NOM[1:49]),\n         title=\"CORRELATION (T0) - Linear Regression\",\n         xlab=\"Waist/Height\",ylab=\"Adipocyte diameter\",\n         legend.topleft=list(title=\"SHAPE\",pch=c(1,0),label=c(\"Female\",\"Male\"),col=c(\"black\",\"black\")),\n         imgfile=sprintf(\"%s/lm_t0_Adipocyte-diameter_vs_Waist_Height.pdf\",output.dir),\n         pointsfile=sprintf(\"%s/lm_t0_Adipocyte-diameter_vs_Waist_Height_points.csv\",output.dir))\n\n\n\n#t0 - \"Adipocyte diameter\" vs \"(Waist*Waist*Height)/4*pi\" by Linear Regression\nreg.plot((clinic.data$tour.de.taille_clin[1:49]*clinic.data$tour.de.taille_clin[1:49]*clinic.data$Taille[1:49])/(4*pi),clinic.data$diam_clin[1:49],\n         type=\"lm\",\n         pch=ifelse(clinic.data$Sexe[1:49]==\"M\", 0, 1),\n         subjects=as.vector(clinic.data$NOM[1:49]),\n         title=\"CORRELATION (T0) - Linear Regression\",\n         xlab=\"(Waist*Waist*Height)/4*pi\",ylab=\"Adipocyte diameter\",\n         legend.topleft=list(title=\"SHAPE\",pch=c(1,0),label=c(\"Female\",\"Male\"),col=c(\"black\",\"black\")),\n         imgfile=sprintf(\"%s/lm_t0_Adipocyte-diameter_vs_Waist2Height_4pi.pdf\",output.dir),\n         pointsfile=sprintf(\"%s/lm_t0_Adipocyte-diameter_vs_Waist2Height_4pi_points.csv\",output.dir))\n\n\n#t0 - \"Height\" vs \"(Waist*Waist*Height)/4*pi\" by Linear Regression\nreg.plot((clinic.data$tour.de.taille_clin[1:49]*clinic.data$tour.de.taille_clin[1:49]*clinic.data$Taille[1:49])/(4*pi),clinic.data$Taille[1:49],\n         type=\"lm\",\n         pch=ifelse(clinic.data$Sexe[1:49]==\"M\", 0, 1),\n         subjects=as.vector(clinic.data$NOM[1:49]),\n         title=\"CORRELATION (T0) - Linear Regression\",\n         xlab=\"(Waist*Waist*Height)/4*pi\",ylab=\"Height\",\n         legend.topleft=list(title=\"SHAPE\",pch=c(1,0),label=c(\"Female\",\"Male\"),col=c(\"black\",\"black\")),\n         imgfile=sprintf(\"%s/lm_t0_Height_vs_Waist2Height_4pi.pdf\",output.dir),\n         pointsfile=sprintf(\"%s/lm_t0_Height_vs_Waist2Height_4pi_points.csv\",output.dir))\n\n\n\n\n\n#t0-t9-t12 - \"Adipocyte diameter\" vs \"Fat mass\" by Linear Regression\nreg.plot(clinic.data$MG.kg_clin,clinic.data$diam_clin,\n         type=\"lm\",\n         pch=ifelse(clinic.data$Sexe[1:49]==\"M\", 0, 1),\n         subjects=as.vector(clinic.data$NOM),\n         title=\"CORRELATION (T0-T9-T12) - Linear Regression\",\n         xlab=\"Fat mass\",ylab=\"Adipocyte diameter\",\n         col=c(rep(\"black\",49),rep(\"blue\",49),rep(\"red\",49)),\n         legend.topleft=list(title=\"COLOR\",pch=c(\"-\",\"-\",\"-\"),label=c(\"T0\",\"T9\",\"T12\"),col=c(\"black\",\"blue\",\"red\")),\n         legend.topright=list(title=\"SHAPE\",pch=c(1,0),label=c(\"Female\",\"Male\"),col=c(\"black\",\"black\")),        \n         imgfile=sprintf(\"%s/lm_t0-t9-t12_Adipocyte-diameter_vs_Fat-mass.pdf\",output.dir),\n         pointsfile=sprintf(\"%s/lm_t0-t9-t12_Adipocyte-diameter_vs_Fat-mass_points.csv\",output.dir))\n\n#t0-t9-t12 - \"Waist\" vs \"Fat mass/Height*Height\" by Linear Regression\nreg.plot(clinic.data$MG.kg_clin/(clinic.data$Taille*clinic.data$Taille),clinic.data$tour.de.taille_clin,\n         type=\"lm\",\n         pch=ifelse(clinic.data$Sexe[1:49]==\"M\", 0, 1), \n         subjects=as.vector(clinic.data$NOM),\n         title=\"CORRELATION (T0-T9-T12) - Linear Regression\",\n         xlab=\"Fat mass/Height*Height\",ylab=\"Waist\",\n         col=c(rep(\"black\",49),rep(\"blue\",49),rep(\"red\",49)),\n         legend.topleft=list(title=\"COLOR\",pch=c(\"-\",\"-\",\"-\"),label=c(\"T0\",\"T9\",\"T12\"),col=c(\"black\",\"blue\",\"red\")),\n         legend.topright=list(title=\"SHAPE\",pch=c(1,0),label=c(\"Female\",\"Male\"),col=c(\"black\",\"black\")),        \n         imgfile=sprintf(\"%s/lm_t0-t9-t12_Waist_vs_Fat-mass_Height2.pdf\",output.dir),\n         pointsfile=sprintf(\"%s/lm_t0-t9-t12_Waist_vs_Fat-mass_Height2_points.csv\",output.dir))\n\n\n\n#t0-t9-t12 - \"Waist\" vs \"Fat mass/Height*Height*Height\" by Linear Regression\nreg.plot(clinic.data$MG.kg_clin/(clinic.data$Taille*clinic.data$Taille*clinic.data$Taille),clinic.data$tour.de.taille_clin,\n         type=\"lm\",\n         pch=ifelse(clinic.data$Sexe[1:49]==\"M\", 0, 1), \n         subjects=as.vector(clinic.data$NOM),\n         title=\"CORRELATION (T0-T9-T12) - Linear Regression\",\n         xlab=\"Fat mass/Height*Height*Height\",ylab=\"Waist\",\n         col=c(rep(\"black\",49),rep(\"blue\",49),rep(\"red\",49)),\n         legend.topleft=list(title=\"COLOR\",pch=c(\"-\",\"-\",\"-\"),label=c(\"T0\",\"T9\",\"T12\"),col=c(\"black\",\"blue\",\"red\")),\n         legend.topright=list(title=\"SHAPE\",pch=c(1,0),label=c(\"Female\",\"Male\"),col=c(\"black\",\"black\")),        \n         imgfile=sprintf(\"%s/lm_t0-t9-t12_Waist_vs_Fat-mass_Height3.pdf\",output.dir),\n         pointsfile=sprintf(\"%s/lm_t0-t9-t12_Waist_vs_Fat-mass_Height3_points.csv\",output.dir))\n\n\n#t0-t9-t12 - \"Adipocyte diameter\" vs \"Waist/Height*Height\" by Linear Regression\nreg.plot(clinic.data$tour.de.taille_clin/(clinic.data$Taille*clinic.data$Taille),clinic.data$diam_clin,\n         type=\"lm\",\n         pch=ifelse(clinic.data$Sexe[1:49]==\"M\", 0, 1),\n         subjects=as.vector(clinic.data$NOM),\n         title=\"CORRELATION (T0-T9-T12) - LOWESS\",\n         xlab=\"Waist/Height*Height\",ylab=\"Adipocyte diameter\",\n         col=c(rep(\"black\",49),rep(\"blue\",49),rep(\"red\",49)),\n         legend.topleft=list(title=\"COLOR\",pch=c(\"-\",\"-\",\"-\"),label=c(\"T0\",\"T9\",\"T12\"),col=c(\"black\",\"blue\",\"red\")),\n         legend.topright=list(title=\"SHAPE\",pch=c(1,0),label=c(\"Female\",\"Male\"),col=c(\"black\",\"black\")),\n         imgfile=sprintf(\"%s/lm_t0-t9-t12_Adipocyte-diameter_vs_Waist_Height2.pdf\",output.dir),\n         pointsfile=sprintf(\"%s/lm_t0-t9-t12_Adipocyte-diameter_vs_Waist_Height2_points.csv\",output.dir))\n\n\n\n\n\n\n\nlm.t0.adfm<-read.csv(sprintf(\"%s/lm_t0_Adipocyte-diameter_vs_Fat-mass_points.csv\",output.dir),header=T)\nlw.t0.adfm<-read.csv(sprintf(\"%s/lw_t0_Adipocyte-diameter_vs_Fat-mass_points.csv\",output.dir),header=T)\nintersect.t0.adfm<-intersect(subset(lm.t0.adfm,Levels==\"1\")$Name,\n                             subset(lw.t0.adfm,Levels==\"1\")$Name)\n\n\nlm.t0.adwh2<-read.csv(sprintf(\"%s/lm_t0_Adipocyte-diameter_vs_Waist_Height2_points.csv\",output.dir),header=T)\nlw.t0.adwh2<-read.csv(sprintf(\"%s/lw_t0_Adipocyte-diameter_vs_Waist_Height2_points.csv\",output.dir),header=T)\nintersect.t0.adwh2<-intersect(subset(lm.t0.adwh2,Levels==\"1\")$Name,\n                              subset(lw.t0.adwh2,Levels==\"1\")$Name)\n\nlm.t0.wfmh2<-read.csv(sprintf(\"%s/lm_t0_Waist_vs_Fat-mass_Height2_points.csv\",output.dir),header=T)\nlw.t0.wfmh2<-read.csv(sprintf(\"%s/lw_t0_Waist_vs_Fat-mass_Height2_points.csv\",output.dir),header=T)\nintersect.t0.wfmh2<-intersect(subset(lm.t0.wfmh2,Levels==\"1\")$Name,\n                              subset(lw.t0.wfmh2,Levels==\"1\")$Name)\n\n\nsubjects.risk<-data.matrix(data.frame(as.vector(lm.t0.adfm$Name),lm.t0.adfm$Levels,lm.t0.adwh2$Levels,lm.t0.wfmh2$Levels,row.names=1))\nsubjects.risk<-subjects.risk[order(rownames(subjects.risk),decreasing=T),]\n\n#write the list of all classified subjects\nwrite.table(rbind(c(\"Name\",\"Adipocyte_Fatmass\",\"Adipocyte_Waist/Height2\",\"Waist_Fatmass/Height2\"),cbind(rownames(subjects.risk),subjects.risk)),file=sprintf(\"%s/Classified-Subjects.csv\",output.dir),col.names=F,row.names=F,sep=\",\",quote=F)\n\n#write the list of all classified subjects\npdf(file=sprintf(\"%s/Classified-Subjects_Heatmap.pdf\",output.dir))\nheatmap(subjects.risk, labCol=c(\"Adipocyte_Fatmass\",\"Adipocyte_Waist/Height2\",\"Waist_Fatmass/Height2\"),\n        cexCol=0.7,Rowv=NA, Colv=NA, col = redblue(3), scale=\"column\", margins=c(7,15))\nlegend(\"topright\", fill = c(\"red\", \"blue\"), legend = c(\"High Risk\", \"Low Risk\"))\ndev.off()\n\n#List of subjects having high risk at all classifications (3)\nrownames(subjects.risk)[subjects.risk[,1]==1&subjects.risk[,2]==1&subjects.risk[,3]==1]\n#[1] \"VIL-OL\" \"NOI-JO\" \"MEU-MU\" \"LAJ-AN\" \"HEN-MU\" \"GAB-AU\" \"CAB-RO\" \"BOR-CL\" \"BIL-JU\"\n#[10] \"BAJ-VE\" \"AYA-LA\" \"ANC-TH\"\n\n\n\n\nALL=F\nif (ALL){\nlm.t0.t9.t12.adfm<-read.csv(sprintf(\"%s/lm_t0_Adipocyte-diameter_vs_Fat-mass_points.csv\",output.dir),header=T)\nlw.t0.t9.t12.adfm<-read.csv(sprintf(\"%s/lw_t0_Adipocyte-diameter_vs_Fat-mass_points.csv\",output.dir),header=T)\nintersect.t0.t9.t12.adfm<-intersect(subset(lm.t0.t9.t12.adfm,Levels==\"1\")$Name,\n                                    subset(lw.t0.t9.t12.adfm,Levels==\"1\")$Name)\n\n\nlm.t0.t9.t12.adwh2<-read.csv(sprintf(\"%s/lm_t0-t9-t12_Adipocyte-diameter_vs_Waist_Height2_points.csv\",output.dir),header=T)\nlw.t0.t9.t12.adwh2<-read.csv(sprintf(\"%s/lw_t0-t9-t12_Adipocyte-diameter_vs_Waist_Height2_points.csv\",output.dir),header=T)\nintersect.t0.t9.t12.adwh2<-intersect(subset(lm.t0.t9.t12.adwh2,Levels==\"1\")$Name,\n                                     subset(lw.t0.t9.t12.adwh2,Levels==\"1\")$Name)\n\nlm.t0.t9.t12.wfmh2<-read.csv(sprintf(\"%s/lm_t0-t9-t12_Waist_vs_Fat-mass_Height2_points.csv\",output.dir),header=T)\nlw.t0.t9.t12.wfmh2<-read.csv(sprintf(\"%s/lw_t0-t9-t12_Waist_vs_Fat-mass_Height2_points.csv\",output.dir),header=T)\nintersect.t0.t9.t12.wfmh2<-intersect(subset(lm.t0.t9.t12.wfmh2,Levels==\"1\")$Name,\n                                     subset(lw.t0.t9.t12.wfmh2,Levels==\"1\")$Name)\n\n\nintersect(intersect(intersect.t0.t9.t12.adfm,intersect.t0.t9.t12.adwh2),intersect.t0.t9.t12.wfmh2)\n\n}\n\n\n#selection numerical variables\ndata<-clinic.data[,c(4:6,10:50,97:98)]\n\n#FUNC get list of highly correlated variables\ngetCorVar<-function(data,alpha){\n  cor.mat<-as.matrix(cor(data,data))\n  cor.mat<-cor.mat*cor.mat\n  cor.mat[upper.tri(cor.mat, diag = T)]<-0\n  icol<-(which(cor.mat>=alpha)-1)%/%ncol(cor.mat)+1\n  irow<-(which(cor.mat>=alpha)-1)%%ncol(cor.mat)+1\n  return(list(var1=names(data)[icol],\n               var2=names(data)[irow],\n              r.squared=diag(cor.mat[irow,icol])))\n}\n\nlibrary(gplots)\n\n#Correlation Clinical Factors \ncor.mat<-as.matrix(cor(data,data))\nr2.cor.mat<-cor.mat*cor.mat\n\n\n#Write R-squared Correlation Coefficients of Clinical Factors\nwrite.table(cbind(c(\"\",colnames(data)),rbind(colnames(data),r2.cor.mat)),file=sprintf(\"%s/Correlated-Clinical-Factors.csv\",output.dir),col.names=F,row.names=F,sep=\",\",quote=F)\n\n#Heatmap of R-squared Correlation Coefficients of Clinical Factors\npdf(file=sprintf(\"%s/Correlated-Clinical-Factors_Heatmap.pdf\",output.dir))\nheatmap.2(r2.cor.mat,dendrogram=\"none\", col=bluered(75), scale=\"none\", key=T, keysize=1.5,\n          density.info=\"none\", trace=\"none\",cexCol=0.6,cexRow=0.6,margins=c(7,7))\nlegend(\"topright\", legend = c(\"Value = R-Squared Correlation Coefficient\"))\ndev.off()\n\n\ncorr.pairs<-getCorVar(data,0.5)\n#Write high correlated clinical factors\nwrite.table(corr.pairs,file=sprintf(\"%s/Highly-Correlated-Clinical-Factors.csv\",output.dir),col.names=T,row.names=F,sep=\",\",quote=F)\n\n\nboxplot.class<-function(data,x,class,outfile){\n  boxplot(data[,x]~class,ylab=names(data)[x],xlab=\"Risk (0=low; 1=high)\")  \n  t.res<-t.test(data[,x]~class,ylab=names(data)[x])\n  title(main=sprintf(\"t=%0.2f; p=%0.2e\\n%s\",t.res$statistic,t.res$p.value,ifelse(t.res$p.value<=0.001,\"***\",ifelse(t.res$p.value<=0.01 & t.res$p.value>0.001,\"**\",ifelse(t.res$p.value<=0.05 & t.res$p.value>0.01,\"*\",\"\")))))\n  out<-cbind(names(data)[x],t.res$statistic,t.res$p.value,ifelse(t.res$p.value<=0.001,\"***\",ifelse(t.res$p.value<=0.01 & t.res$p.value>0.001,\"**\",ifelse(t.res$p.value<=0.05 & t.res$p.value>0.01,\"*\",\"\"))))\n  write.table(out,outfile,col.names=F,row.names=F,append=T,quote=F,sep=\";\")\n}\n\n#deparse(substitute(var)) \n#attributes(output)\n\n\nclassified.wfmh2.t0<-read.csv(sprintf(\"%s/CLASSIFICATION/Subjects/lm_t0_Waist_vs_Fat-mass_Height2_points.csv\",output.dir))\n\npdf(sprintf(\"%s/CLASSIFICATION/Subjects/lm_t0_Waist_vs_Fat-mass_Height2_boxplot.pdf\",output.dir))\noutfile=sprintf(\"%s/CLASSIFICATION/Subjects/lm_t0_Waist_vs_Fat-mass_Height2_t-test.csv\",output.dir)\npar(mfrow = c(4, 4))\nlapply(c(4:6,10:98),function(x) boxplot.class(clinic.data[1:49,],x,classified.wfmh2.t0[,4],outfile))\ndev.off()\n\n\nclassified.adfm.t0<-read.csv(sprintf(\"%s/CLASSIFICATION/Subjects/lm_t0_Adipocyte-diameter_vs_Fat-mass_points.csv\",output.dir))\n\npdf(sprintf(\"%s/CLASSIFICATION/Subjects/lm_t0_Adipocyte-diameter_vs_Fat-mass_boxplot.pdf\",output.dir))\noutfile<-sprintf(\"%s/CLASSIFICATION/Subjects/lm_t0_Adipocyte-diameter_vs_Fat-mass_t-test.csv\",output.dir)\npar(mfrow = c(4, 4))\nlapply(c(4:6,10:98),function(x) boxplot.class(clinic.data[1:49,],x,classified.adfm.t0[,4],outfile))\ndev.off()\n\n\nclassified.adwh2.t0<-read.csv(sprintf(\"%s/CLASSIFICATION/Subjects/lm_t0_Adipocyte-diameter_vs_Waist_Height2_points.csv\",output.dir))\n\npdf(sprintf(\"%s/CLASSIFICATION/Subjects/lm_t0_Adipocyte-diameter_vs_Waist_Height2_boxplot.pdf\",output.dir))\noutfile<-sprintf(\"%s/CLASSIFICATION/Subjects/lm_t0_Adipocyte-diameter_vs_Waist_Height2_t-test.csv\",output.dir)\npar(mfrow = c(4, 4))\nlapply(c(4:6,10:98),function(x) boxplot.class(clinic.data[1:49,],x,classified.adwh2.t0[,4],outfile))\ndev.off()\n\n\n\n\n\n\nalim.data<-get(load(sprintf(\"%s/DonneeCliniques0_6_12Sem_3avril2010_Alimentaire.xls.RData\",input.dir)))\n\n\nclassified.wfmh2.t0<-read.csv(sprintf(\"%s/CLASSIFICATION/Subjects/lm_t0_Waist_vs_Fat-mass_Height2_points.csv\",output.dir))\nalim.classified.wfmh2.t0<-classified.adwh2.t0[which(classified.adwh2.t0[,1] %in% alim.data$NOM[1:24]),]\nalim.classified.wfmh2.t0<-alim.classified.wfmh2.t0[order(alim.classified.wfmh2.t0$Name),]\n\npdf(sprintf(\"%s/CLASSIFICATION/Subjects/lm_t0_Waist_vs_Fat-mass_Height2_Alim_boxplot.pdf\",output.dir))\noutfile=sprintf(\"%s/CLASSIFICATION/Subjects/lm_t0_Waist_vs_Fat-mass_Height2_Alim_t-test.csv\",output.dir)\npar(mfrow = c(4, 4))\nlapply(c(4,8:44),function(x) boxplot.class(alim.data[1:24,],x,alim.classified.wfmh2.t0[,4],outfile))\ndev.off()\n\n\nclassified.adfm.t0<-read.csv(sprintf(\"%s/CLASSIFICATION/Subjects/lm_t0_Adipocyte-diameter_vs_Fat-mass_points.csv\",output.dir))\nalim.classified.adfm.t0<-classified.adfm.t0[which(classified.adfm.t0[,1] %in% alim.data$NOM[1:24]),]\nalim.classified.adfm.t0<-alim.classified.adfm.t0[order(alim.classified.adfm.t0$Name),]\n\npdf(sprintf(\"%s/CLASSIFICATION/Subjects/lm_t0_Adipocyte-diameter_vs_Fat-mass_Alim_boxplot.pdf\",output.dir))\noutfile<-sprintf(\"%s/CLASSIFICATION/Subjects/lm_t0_Adipocyte-diameter_vs_Fat-mass_Alim_t-test.csv\",output.dir)\npar(mfrow = c(4, 4))\nlapply(c(4,8:44),function(x) boxplot.class(alim.data[1:24,],x,alim.classified.adfm.t0[,4],outfile))\ndev.off()\n\n\nclassified.adwh2.t0<-read.csv(sprintf(\"%s/CLASSIFICATION/Subjects/lm_t0_Adipocyte-diameter_vs_Waist_Height2_points.csv\",output.dir))\nalim.classified.adwh2.t0<-classified.adwh2.t0[which(classified.adwh2.t0[,1] %in% alim.data$NOM[1:24]),]\nalim.classified.adwh2.t0<-alim.classified.adwh2.t0[order(alim.classified.adwh2.t0$Name),]\n\npdf(sprintf(\"%s/CLASSIFICATION/Subjects/lm_t0_Adipocyte-diameter_vs_Waist_Height2_Alim_boxplot.pdf\",output.dir))\noutfile<-sprintf(\"%s/CLASSIFICATION/Subjects/lm_t0_Adipocyte-diameter_vs_Waist_Height2_Alim_t-test.csv\",output.dir)\npar(mfrow = c(4, 4))\nlapply(c(4,8:44),function(x) boxplot.class(alim.data[1:24,],x,alim.classified.adwh2.t0[,4],outfile))\ndev.off()\n\n\n\n\n\n\n\n\n#TUONG\n\nclassified.wfmh.t0<-read.csv(sprintf(\"%s/CLASSIFICATION/Subjects/lm_t0_Waist_vs_Fat-mass_Height_points.csv\",output.dir))\nalim.classified.wfmh.t0<-classified.adwh.t0[which(classified.adwh.t0[,1] %in% alim.data$NOM[1:24]),]\nalim.classified.wfmh.t0<-alim.classified.wfmh.t0[order(alim.classified.wfmh.t0$Name),]\n\npdf(sprintf(\"%s/CLASSIFICATION/Subjects/lm_t0_Waist_vs_Fat-mass_Height_Alim_boxplot.pdf\",output.dir))\noutfile=sprintf(\"%s/CLASSIFICATION/Subjects/lm_t0_Waist_vs_Fat-mass_Height_Alim_t-test.csv\",output.dir)\npar(mfrow = c(4, 4))\nlapply(c(4,8:44),function(x) boxplot.class(alim.data[1:24,],x,alim.classified.wfmh.t0[,4],outfile))\ndev.off()\n\n\nclassified.adwh.t0<-read.csv(sprintf(\"%s/CLASSIFICATION/Subjects/lm_t0_Adipocyte-diameter_vs_Waist_Height_points.csv\",output.dir))\nalim.classified.adwh.t0<-classified.adwh.t0[which(classified.adwh.t0[,1] %in% alim.data$NOM[1:24]),]\nalim.classified.adwh.t0<-alim.classified.adwh.t0[order(alim.classified.adwh.t0$Name),]\n\npdf(sprintf(\"%s/CLASSIFICATION/Subjects/lm_t0_Adipocyte-diameter_vs_Waist_Height_Alim_boxplot.pdf\",output.dir))\noutfile<-sprintf(\"%s/CLASSIFICATION/Subjects/lm_t0_Adipocyte-diameter_vs_Waist_Height_Alim_t-test.csv\",output.dir)\npar(mfrow = c(4, 4))\nlapply(c(4,8:44),function(x) boxplot.class(alim.data[1:24,],x,alim.classified.adwh.t0[,4],outfile))\ndev.off()\n\n\nclassified.ahw2h4.t0<-read.csv(sprintf(\"%s/CLASSIFICATION/Subjects/lm_t0_Height_vs_Waist2Height_4pi_points.csv\",output.dir))\nalim.classified.ahw2h4.t0<-classified.ahw2h4.t0[which(classified.ahw2h4.t0[,1] %in% alim.data$NOM[1:24]),]\nalim.classified.ahw2h4.t0<-alim.classified.ahw2h4.t0[order(alim.classified.ahw2h4.t0$Name),]\n\npdf(sprintf(\"%s/CLASSIFICATION/Subjects/lm_t0_Height_vs_Waist2Height_4pi_Alim_boxplot.pdf\",output.dir))\noutfile<-sprintf(\"%s/CLASSIFICATION/Subjects/lm_t0_Height_vs_Waist2Height_4pi_Alim_t-test.csv\",output.dir)\npar(mfrow = c(4, 4))\nlapply(c(4,8:44),function(x) boxplot.class(alim.data[1:24,],x,alim.classified.ahw2h4.t0[,4],outfile))\ndev.off()\n\n\np.clinic.adfm<-read.table(sprintf(\"%s/CLASSIFICATION/Subjects/lm_t0_Adipocyte-diameter_vs_Fat-mass_t-test.csv\",output.dir),sep=\";\")\np.clinic.wfmh2<-read.table(sprintf(\"%s/CLASSIFICATION/Subjects/lm_t0_Waist_vs_Fat-mass_Height2_t-test.csv\",output.dir),sep=\";\")\np.clinic.adwh2<-read.table(sprintf(\"%s/CLASSIFICATION/Subjects/lm_t0_Adipocyte-diameter_vs_Waist_Height2_t-test.csv\",output.dir),sep=\";\")\np.alim.adfm<-read.table(sprintf(\"%s/CLASSIFICATION/Subjects/lm_t0_Adipocyte-diameter_vs_Fat-mass_Alim_t-test.csv\",output.dir),sep=\";\")\np.alim.wfmh2<-read.table(sprintf(\"%s/CLASSIFICATION/Subjects/lm_t0_Waist_vs_Fat-mass_Height2_Alim_t-test.csv\",output.dir),sep=\";\")\np.alim.adwh2<-read.table(sprintf(\"%s/CLASSIFICATION/Subjects/lm_t0_Adipocyte-diameter_vs_Waist_Height2_Alim_t-test.csv\",output.dir),sep=\";\")\n\np.clinic.all<-rbind(c(\"clinic.factors\",\"ad.fm\",\"w.fmh2\",\"ad.wh2\"),\n                    cbind(as.character(p.clinic.adfm[,1]),\n                          p.clinic.adfm[,3],\n                          p.clinic.wfmh2[,3],\n                          p.clinic.adwh2[,3]))\n\nwrite.table(p.clinic.all,sprintf(\"%s/CLASSIFICATION/Subjects/diff_high-low-risk_clinic_p-values.csv\",output.dir),col.names=F,row.names=F,quote=F,sep=\";\")\n\n\np.alim.all<-rbind(c(\"alim.factors\",\"ad.fm\",\"w.fmh2\",\"ad.wh2\"),\n                    cbind(as.character(p.alim.adfm[,1]),\n                          p.alim.adfm[,3],\n                          p.alim.wfmh2[,3],\n                          p.alim.adwh2[,3]))\n\nwrite.table(p.alim.all,sprintf(\"%s/CLASSIFICATION/Subjects/diff_high-low-risk_alim_p-values.csv\",output.dir),col.names=F,row.names=F,quote=F,sep=\";\")\n\np.star.clinic.all<-rbind(c(\"clinic.factors\",\"ad.fm\",\"w.fmh2\",\"ad.wh2\"),\n                    cbind(as.character(p.clinic.adfm[,1]),\n                          as.character(p.clinic.adfm[,4]),\n                          as.character(p.clinic.wfmh2[,4]),\n                          as.character(p.clinic.adwh2[,4])))\n\n\n\n\nwrite.table(p.star.clinic.all,sprintf(\"%s/CLASSIFICATION/Subjects/diff_high-low-risk_clinic_p-values-star.csv\",output.dir),col.names=F,row.names=F,quote=F,sep=\";\")\n\np.star.alim.all<-rbind(c(\"alim.factors\",\"ad.fm\",\"w.fmh2\",\"ad.wh2\"),\n                  cbind(as.character(p.alim.adfm[,1]),\n                        as.character(p.alim.adfm[,4]),\n                        as.character(p.alim.wfmh2[,4]),\n                        as.character(p.alim.adwh2[,4])))\n\n\nwrite.table(p.star.alim.all,sprintf(\"%s/CLASSIFICATION/Subjects/diff_high-low-risk_alim_p-values-star.csv\",output.dir),col.names=F,row.names=F,quote=F,sep=\";\")\n\n\n\n\ndiff.alim.groups.star<-read.table(sprintf(\"%s/CLASSIFICATION/Subjects/diff_high-low-risk_alim_p-values-star.csv\",output.dir),header=T,sep=\";\")\nlibrary(xtable)\nprint(xtable(diff.alim.groups.star),include.rownames=FALSE)\n\n\ndiff.clinic.groups.star<-read.csv(sprintf(\"%s/CLASSIFICATION/Subjects/diff_high-low-risk_clinic_p-values-star.csv\",output.dir),header=T,sep=\";\")\nprint(xtable(diff.clinic.groups.star),include.rownames=FALSE)\n\n\nclinic.data.rate<-clinic.data[,10:ncol(clinic.data)]\nclinic.data.rate<-sapply(10:ncol(clinic.data), function (x) clinic.data[,x]/max(clinic.data[,x]))\ncolnames(clinic.data.rate)<-names(clinic.data)[10:ncol(clinic.data)]\ncolnames(clinic.data.rate)\n\nplot(clinic.data.rate[,1],clinic.data.rate[,4])\ncor(clinic.data.rate[,1],clinic.data.rate[,4])\n\nplot(clinic.data[,10],clinic.data[,13])\ncor(clinic.data[,10],clinic.data[,13])\n\nplot.mc<-function(x,y){\n  x.rate<-x/max(x)\n  y.rate<-y/max(y)\n  plot(x.rate,y.rate,xlim=c(0,1),ylim=c(0,1))\n}\n\nplot.mc(clinic.data[,10],clinic.data[,13])\n\n#'@name normality.mc\n#'@aliases normality.mc\n#'@docType methods\n#'@rdname normality.mc\n#'@title Normality Test\n#'@description Perform a normality test for variables \n#'@param m variable (list, matrix, data frame...)\n#'@param alpha p-value threshold\n#'@return logical value indicating whether variable is normally distributed\n#'@author Hoai Tuong Nguyen\n#'@example\n#' attach(mtcars)\n#' normality.mc(mtcars)\nnormality.mc<-function(m,alpha=0.05){\n  if (class(m)==\"data.frame\" || class(m)==\"matrix\")\n    return(sapply(1:ncol(m), function(x) normality.mc(m[,x])$p.value<=alpha))\n  else return(shapiro.test(m)$p.value<=alpha)\n}\n\nnormality.mc(clinic.data[,10])\n\n#'@name class.mc\n#'@aliases class.mc\n#'@docType methods\n#'@rdname class.mc\n#'@title Object Classes\n#'@description Get class of variable\n#'@param variable (list, matrix, data frame...)\n#'@return class of variables or of columns of matrix/data frame\n#'@author Hoai Tuong Nguyen\n#'@example\n#' attach(mtcars)\n#' class.mc(mtcars)\nclass.mc<-function(m){\n  if (class(m)==\"data.frame\" || class(m)==\"matrix\")\n    return(sapply(1:ncol(m),function(x) class(m[,x])))\n  else return(class(m))\n}\n\n\n\ndata<-clinic.data[,c(4:6,10:55,97,98)]\n\ncor.mat<-cor(data,data)\ncor.mat<-cor.mat*cor.mat\ndiag(cor.mat)<-0\nhead(cor.mat[(cor.mat[,1]),1],20)\n\nadjac.mat<-cor.mat>0.2\nsapply(1:ncol(adjac.mat), function(x) which(adjac.mat[,x])\n\n",
    "created" : 1371137824344.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1475147997",
    "id" : "39625029",
    "lastKnownWriteTime" : 1371126546,
    "path" : "~/metacardis/3.results/CLASSIFICATION/Subjects/classifySubjects.R",
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_source"
}