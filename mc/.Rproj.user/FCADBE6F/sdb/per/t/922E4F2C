{
    "contents" : "#########################################\n# classifySubjects.R - Classify subjects\n# Author: Hoai Tuong Nguyen\n# Created: 30/05/2013\n# Modified: 31/05/2013\n#########################################\n\n#Load imputed data\nclinic.data<-get(load(\"../1.data/metacardis/DonneeCliniques0_6_12Sem_3avril2010.xls.imputed.RData\"))\n\n\n#\"diam_clin\" = adipocyte diametre\n#\"tour.de.taille_clin\"= Waist\n#\"MG.kg_clin\" = Fat mas en KG (absolu)\n#\"MG.percent_clin\" = Fat mass/body weight %\n#\"Taille\"= Height\n\n\n#FUNC plot a pair of variables and lowess line\n#Dependencies: Hmisc\nlowess.plot<-function(x,y,subjects=NULL,title=\"CORRELATION\",xlab=\"X\",ylab=\"Y\",col,legend,imgfile=NULL,pointsfile=NULL){\n  r=rcorr(x,y,type=\"pearson\")[[1]][1,2]\n  rho=rcorr(x,y,type=\"spearman\")[[1]][1,2]\n  if (!missing(imgfile))\n    pdf(file=imgfile)\n  if (missing(col))\n    col=rep(\"black\",length(x),)\n  plot(x,y,main=sprintf(\"%s\\n%s vs %s \\nr=%0.4f; rho=%0.4f\",title,ylab,xlab,r,rho),xlab=xlab,ylab=ylab,col=col)\n  textxy(x, y, subjects, cx = 0.3,m = c(0, 0))\n  lw<-lowess(x,y)\n  lines(lw,col=3)\n  if (!missing(legend))\n    legend(\"topleft\",legend = legend$label, col = legend$col, pch=1)\n  if (!missing(imgfile))\n    dev.off()\n  if (!missing(pointsfile))\n    up<-which(x>lw[[1]] & y>lw[[2]])\n  p<-rep(\"low\",length(x))\n  p[up]<-\"high\"\n  if (!missing(subjects))\n    write.table(rbind(c(\"Name\",xlab,ylab,\"Levels\"),cbind(subjects,x,y,p)),file=pointsfile,col.names=F,row.names=F,sep=\",\",quote=F)\n  else \n    write.table(rbind(c(xlab,ylab,\"Levels\"),cbind(x,y,p)),file=pointsfile,col.names=F,row.names=T,quote=F)\n}\n\n\n\n\n#FUNC plot a pair of variables and linear regression line\n#Dependencies: Hmisc\nlm.plot<-function(x,y, subjects=NULL,title=\"CORRELATION\",xlab=\"X\",ylab=\"Y\",col,legend,imgfile=NULL,pointsfile=NULL){\n  r=rcorr(x,y,type=\"pearson\")[[1]][1,2]\n  rho=rcorr(x,y,type=\"spearman\")[[1]][1,2]\n  if (!missing(imgfile))\n    pdf(file=imgfile)\n  if (missing(col))\n    col=rep(\"black\",length(x),)\n  plot(x,y,main=sprintf(\"%s\\n%s vs %s \\nr=%0.4f; rho=%0.4f\",title,ylab,xlab,r,rho),xlab=xlab,ylab=ylab,col=col)\n  textxy(x, y, subjects, cx = 0.3,m = c(0, 0))\n  lm<-lm(y~x)\n  abline(lm)\n  if (!missing(legend))\n    legend(\"topleft\",legend = legend$label, col = legend$col, pch=1)\n  if (!missing(imgfile))\n    dev.off()\n  if (!missing(pointsfile))\n    up<-which(y>(lm[[1]][2]*x + lm[[1]][1]))\n  p<-rep(\"low\",length(x))\n  p[up]<-\"high\"\n  if (!missing(subjects))\n    write.table(rbind(c(\"Name\",xlab,ylab,\"Levels\"),cbind(subjects,x,y,p)),file=pointsfile,col.names=F,row.names=F,sep=\",\",quote=F)\n  else \n    write.table(rbind(c(xlab,ylab,\"Levels\"),cbind(x,y,p)),file=pointsfile,col.names=F,row.names=T,quote=F)\n}\n\n\nrequire(\"Hmisc\")\n\n#t0 - \"Adipocyte diameter\" vs \"Fat mass\"\nlowess.plot(clinic.data$MG.kg_clin[1:49],clinic.data$diam_clin[1:49],\n            subjects=as.vector(clinic.data$NOM[1:49]),\n            title=\"CORRELATION (T0) - LOWESS\",\n            xlab=\"Fat mass\",ylab=\"Adipocyte diameter\",\n            imgfile=\"../3.results/CLASSIFICATION/Subjects/lw_t0_Adipocyte-diameter_vs_Fat-mass.pdf\",\n            pointsfile=\"../3.results/CLASSIFICATION/Subjects/lw_t0_Adipocyte-diameter_vs_Fat-mass_points.csv\")\n\n#t0 - \"Waist\" vs \"Fat mass/Height*Height\"\nlowess.plot(clinic.data$MG.kg_clin[1:49]/(clinic.data$Taille[1:49]*clinic.data$Taille[1:49]),clinic.data$tour.de.taille_clin[1:49],\n            subjects=as.vector(clinic.data$NOM[1:49]),\n            title=\"CORRELATION (T0) - LOWESS\",\n            xlab=\"Fat mass/Height*Height\",ylab=\"Waist\",\n            imgfile=\"../3.results/CLASSIFICATION/Subjects/lw_t0_Waist_vs_Fat-mass_Height2.pdf\",\n            pointsfile=\"../3.results/CLASSIFICATION/Subjects/lw_t0_Waist_vs_Fat-mass_Height2_points.csv\")\n\n\n\n\n#\"Adipocyte diameter\" vs \"Fat mass\"\nlm.plot(clinic.data$MG.kg_clin,clinic.data$diam_clin,\n            subjects=as.vector(clinic.data$NOM),\n            title=\"CORRELATION (T0-T9-T12) - Linear Regression\",\n            xlab=\"Fat mass\",ylab=\"Adipocyte diameter\",\n            col=c(rep(\"black\",length(clinic.data$MG.kg_clin)/3),rep(\"blue\",length(clinic.data$MG.kg_clin)/3),rep(\"red\",length(clinic.data$MG.kg_clin)/3)),\n            legend=list(label=c(\"T0\",\"T9\",\"T12\"),col=c(\"black\",\"blue\",\"red\")),\n            imgfile=\"../3.results/CLASSIFICATION/Subjects/lm_t0-t9-t12_Adipocyte-diameter_vs_Fat-mass.pdf\",\n            pointsfile=\"../3.results/CLASSIFICATION/Subjects/lm_t0-t9-t12_Adipocyte-diameter_vs_Fat-mass_points.csv\")\n\n#\"Waist\" vs \"Fat mass/Height*Height\"\nlm.plot(clinic.data$MG.kg_clin/(clinic.data$Taille*clinic.data$Taille),clinic.data$tour.de.taille_clin,\n            subjects=as.vector(clinic.data$NOM),\n            title=\"CORRELATION (T0-T9-T12) - Linear Regression\",\n            xlab=\"Fat mass/Height*Height\",ylab=\"Waist\",\n            col=c(rep(\"black\",length(clinic.data$MG.kg_clin)/3),rep(\"blue\",length(clinic.data$MG.kg_clin)/3),rep(\"red\",length(clinic.data$MG.kg_clin)/3)),\n            legend=list(label=c(\"T0\",\"T9\",\"T12\"),col=c(\"black\",\"blue\",\"red\")),\n            imgfile=\"../3.results/CLASSIFICATION/Subjects/lm_t0-t9-t12_Waist_vs_Fat-mass_Height2.pdf\",\n            pointsfile=\"../3.results/CLASSIFICATION/Subjects/lm_t0-t9-t12_Waist_vs_Fat-mass_Height2_points.csv\")\n",
    "created" : 1371137802869.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3842567743",
    "id" : "922E4F2C",
    "lastKnownWriteTime" : 1370011524,
    "path" : "~/metacardis/7.scripts/CLASSIFICATION/classifySubjects.R",
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_source"
}